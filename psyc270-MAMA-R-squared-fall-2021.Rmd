---
title: |
    | Psyc 270 (aka MAMA aka R-squared)
    | Fall 2021 Schedule
author: "Michael A. Erickson"
date: "`r Sys.Date()`"
output:
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
    keep_tex: yes
  tufte::tufte_html: default
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
bibliography: skeleton.bib
link-citations: yes
---

```{r setup, include=FALSE}
library(knitr)
library(kableExtra)
library(tufte)
library(tidyverse)
library(googlesheets4)
# invalidate cache when the tufte version changes
knitr::opts_chunk$set(cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```

`r newthought("If you just want")` to see the schedule for Psyc 270 (aka MAMA aka R-squared), skip down to Table 1 below.

# Set up Schedule

`r newthought("This is not a great way")` to enter the schedule, but since it is only 10 weeks, it's not that big of a deal.^[One of the `tidyverse`'s biggest shortcomings seems to be its awkwardness in changing individual cells.  The `mutate()` call doesn't make nearly as much sense here as the regular R bracket notation to access individual cells.]

This makes a "tibble" (essentially a spreadsheet) filled in with one Tuesday date per row that says that is an Open Forum with no speaker and no topic.  It then fills in speakers and topics as they come along.

```{r make-sched}
fall_2021 <- 
  tibble(Date = seq(as.Date('2021-09-28'),
                    as.Date('2021-12-03'),
                    by = 'week'),
         `Meeting Type` = "Open Forum", 
         Speaker = "", Topic = "") %>%
  mutate(`Meeting Type` = ifelse(Date %in% as.Date(c('2021-10-12', '2021-10-19')),
                                 "Presentation", `Meeting Type`),
         Speaker = case_when(Date == '2021-09-28' ~ "Sonja Lyubomirsky",
                             Date == '2021-10-12' ~ "Roy Baumeister",
                             Date == '2021-10-19' ~ "Calen Horton",
                             Date == '2021-11-02' ~ "Karynna Okabe-Miyamoto",
                             Date == '2021-11-09' ~ "Pavani Jonnalagadda",
                             TRUE ~ Speaker),
         Topic = case_when(Date == '2021-09-28' ~ "Model of Positive Psychology",
                           Date == '2021-10-12' ~
                             "Multi-site Replication Attempts in Social Psychology",
                           Date == '2021-10-19' ~
                             "A Cross-Methodological Comparison of the Factor Structure of Situations",
                           Date == '2021-11-02' ~ "Missing Data",
                           Date == '2021-11-09' ~
                             "Modern Validation of a Masculinity and Femininity Scale",
                           TRUE ~ Topic)) %>%
  arrange(Date)

```


# Display Schedule

This uses `kable()` to display the "tibble" with nice formatting.

```{r show-sched, warning=FALSE}
kable(fall_2021, booktabs=TRUE, longtable=TRUE, 
      caption="Fall 2021 Psyc 270 (aka MAMA aka R-Squared) schedule.") %>%
  kable_styling(latex_options=c("repeat_header"), full_width = FALSE) %>%
  column_spec(3:4, width = c("10em", "15em"))

```


# Write Schedule to a Google Sheet

Need to work out permissions here.

```{r}
## ss <-
##  gs4_create("Psyc-270-2021-Fall",
##             sheets = fall_2021)
```


```{r bib, include=FALSE}
# create a bib file for the R packages used in this document
knitr::write_bib(c('base', 'rmarkdown'), file = 'skeleton.bib')
```
